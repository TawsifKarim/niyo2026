<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talent Galaxy - Pipeline View</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #0f172a;
            color: white;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gravity-btn.active {
            background-color: #6366f1;
            border-color: #818cf8;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
            transform: translateY(-2px);
        }

        canvas {
            display: block;
        }
    </style>
</head>

<body class="h-screen overflow-hidden flex flex-col">

    <div id="app" class="h-full relative flex flex-col">

        <!-- Header Overlay -->
        <header
            class="absolute top-0 left-0 w-full z-20 px-8 py-6 flex justify-between items-start pointer-events-none">
            <div class="pointer-events-auto">
                <h1
                    class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400">
                    Talent Galaxy</h1>
                <p class="text-slate-400 text-sm mt-1">Senior Product Designer â€¢ <span class="text-emerald-400">18
                        Candidates</span></p>
            </div>

            <div class="glass-panel rounded-2xl p-4 flex gap-6 pointer-events-auto">
                <div class="text-center">
                    <div class="text-xs text-slate-400 uppercase tracking-wider font-bold">Orbit 1 (Top 5%)</div>
                    <div class="text-xl font-bold text-white">4</div>
                </div>
                <div class="w-px bg-white/10"></div>
                <div class="text-center">
                    <div class="text-xs text-slate-400 uppercase tracking-wider font-bold">Orbit 2 (Top 20%)</div>
                    <div class="text-xl font-bold text-slate-300">8</div>
                </div>
                <div class="w-px bg-white/10"></div>
                <div class="text-center">
                    <div class="text-xs text-slate-400 uppercase tracking-wider font-bold">Orbit 3</div>
                    <div class="text-xl font-bold text-slate-500">6</div>
                </div>
            </div>
        </header>

        <!-- Canvas Area -->
        <div class="flex-1 relative bg-slate-900 overflow-hidden">
            <!-- Space Background -->
            <div
                class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-800 via-slate-900 to-black z-0">
            </div>
            <canvas id="galaxyCanvas" class="relative z-10 w-full h-full cursor-move"></canvas>

            <!-- Hover Popover (Dynamic Position) -->
            <div v-if="hoveredCandidate"
                class="absolute z-30 w-64 glass-panel rounded-xl p-4 shadow-2xl pointer-events-none transition-opacity duration-200"
                :style="{ left: tooltipPos.x + 'px', top: tooltipPos.y + 'px', opacity: hoveredCandidate ? 1 : 0 }">

                <div class="flex items-center gap-3 mb-3">
                    <img :src="hoveredCandidate.avatar" class="w-10 h-10 rounded-full border border-white/20">
                    <div>
                        <h3 class="font-bold text-sm text-white">{{ hoveredCandidate.name }}</h3>
                        <p class="text-xs text-indigo-300">{{ hoveredCandidate.role }}</p>
                    </div>
                </div>

                <div class="space-y-2">
                    <div class="flex justify-between text-xs">
                        <span class="text-slate-400">Avg Score</span>
                        <span class="font-bold text-emerald-400">{{ hoveredCandidate.average }}%</span>
                    </div>
                    <div class="h-1 bg-white/10 rounded-full overflow-hidden">
                        <div class="h-full bg-emerald-500" :style="{ width: hoveredCandidate.average + '%' }"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gravity Control Dock -->
        <div
            class="absolute bottom-8 left-1/2 -translate-x-1/2 z-20 w-auto max-w-4xl glass-panel rounded-full px-8 py-4 flex items-center gap-6 shadow-2xl border border-indigo-500/20">
            <span class="text-xs font-bold text-indigo-300 uppercase tracking-widest mr-2">Gravity Filters</span>

            <button v-for="skill in skills" :key="skill" @click="toggleGravity(skill)"
                class="gravity-btn px-4 py-2 rounded-full border border-white/10 bg-white/5 text-sm font-medium text-slate-200 transition-all duration-300 hover:bg-white/10 hover:text-white"
                :class="{ 'active': activeGravity === skill }">
                {{ skill }}
            </button>

            <button @click="resetGravity" v-if="activeGravity"
                class="ml-4 text-xs text-slate-400 hover:text-white underline">Reset</button>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, computed } = Vue;

        createApp({
            setup() {
                const activeGravity = ref(null);
                const skills = ['Leadership', 'Experience', 'Innovation', 'Education', 'Certification'];

                const hoveredCandidate = ref(null);
                const tooltipPos = ref({ x: 0, y: 0 });

                // Reuse logic from Talent Matrix to gen random stats if needed, or static list
                const candidates = ref([
                    // Top Tier
                    { id: 1, name: "Sarah Chen", role: "Product Design", avatar: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 92, Leadership: 78, Innovation: 88, Education: 85, Certification: 80 } },
                    { id: 3, name: "Emma Wilson", role: "Marketing", avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 88, Leadership: 96, Innovation: 85, Education: 82, Certification: 70 } },
                    { id: 7, name: "Sophia Miller", role: "Sales Lead", avatar: "https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 95, Leadership: 90, Innovation: 40, Education: 60, Certification: 50 } },
                    { id: 4, name: "David Kim", role: "Data Science", avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 85, Leadership: 70, Innovation: 92, Education: 98, Certification: 88 } },

                    // Mid Tier
                    { id: 2, name: "Michael Torres", role: "Engineering", avatar: "https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 75, Leadership: 65, Innovation: 70, Education: 88, Certification: 95 } },
                    { id: 5, name: "Olivia James", role: "Research", avatar: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 80, Leadership: 75, Innovation: 65, Education: 85, Certification: 70 } },
                    { id: 9, name: "Ava Taylor", role: "Product Manager", avatar: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 82, Leadership: 88, Innovation: 82, Education: 85, Certification: 75 } },
                    { id: 10, name: "Ethan Hunt", role: "Security", avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 88, Leadership: 70, Innovation: 60, Education: 75, Certification: 100 } },
                    { id: 13, name: "Mia Davis", role: "HR Manager", avatar: "https://images.unsplash.com/photo-1491349174775-aaafddd81942?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 85, Leadership: 92, Innovation: 75, Education: 80, Certification: 85 } },

                    // Lower Tier
                    { id: 6, name: "James Liu", role: "Backend Dev", avatar: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 65, Leadership: 50, Innovation: 75, Education: 70, Certification: 85 } },
                    { id: 8, name: "Lucas Brown", role: "DevOps", avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 78, Leadership: 60, Innovation: 68, Education: 80, Certification: 98 } },
                    { id: 12, name: "Mason Clark", role: "Accountant", avatar: "https://images.unsplash.com/photo-1599566150163-29194dcaad36?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 70, Leadership: 55, Innovation: 40, Education: 90, Certification: 95 } },
                    { id: 14, name: "Kevin White", role: "Junior Intern", avatar: "https://images.unsplash.com/photo-1595152772835-219674b2a8a6?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 20, Leadership: 15, Innovation: 25, Education: 40, Certification: 10 } },
                    { id: 15, name: "Liam Harris", role: "Support", avatar: "https://images.unsplash.com/photo-1502452213786-a5bc0a67e963?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 35, Leadership: 25, Innovation: 15, Education: 30, Certification: 20 } },
                    { id: 18, name: "Chris Green", role: "Analyst", avatar: "https://images.unsplash.com/photo-1504257432389-52343af06ae3?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 45, Leadership: 30, Innovation: 45, Education: 40, Certification: 40 } }
                ]);

                // Physics Engine State
                let animationFrameId;
                let canvas, ctx;
                let planets = [];
                let centerX, centerY;

                // Init data
                candidates.value.forEach(acc => {
                    acc.average = Math.round(Object.values(acc.stats).reduce((a, b) => a + b, 0) / 5);
                });

                const toggleGravity = (skill) => {
                    activeGravity.value = activeGravity.value === skill ? null : skill;
                };

                const resetGravity = () => {
                    activeGravity.value = null;
                };

                // ---- PHYSICS & RENDERING ----

                class Planet {
                    constructor(data, img) {
                        this.data = data;
                        this.img = img;
                        this.size = 36 + (data.average * 0.15); // Size based on score
                        this.radius = this.size / 2;

                        // Initial orbit calculation (Distance inversely proportional to score)
                        // Higher score = Closer to center (Sun)
                        this.baseOrbitDist = 100 + (100 - data.average) * 6;
                        this.angle = Math.random() * Math.PI * 2;
                        this.speed = (Math.random() * 0.002) + 0.0005; // Different orbit speeds

                        // Physics position
                        this.x = 0;
                        this.y = 0;

                        // For gravity animation
                        this.targetX = 0;
                        this.targetY = 0;
                        this.isBeingPulled = false;
                    }

                    update(gravitySkill) {
                        // Base Orbital Motion
                        this.angle += this.speed;

                        // Calculate "Natural" Orbit Position
                        let orbitDist = this.baseOrbitDist;
                        let pullStrength = 0.05;

                        if (gravitySkill) {
                            const score = this.data.stats[gravitySkill];
                            if (score > 80) {
                                // STRONG PULL
                                orbitDist = 80; // Pull very close
                                pullStrength = 0.1;
                                this.isBeingPulled = true;
                            } else if (score > 60) {
                                // MEDIUM PULL
                                orbitDist = 200;
                                pullStrength = 0.08;
                                this.isBeingPulled = true;
                            } else {
                                // PUSH AWAY (Weak match)
                                orbitDist = 600;
                                pullStrength = 0.02;
                                this.isBeingPulled = false;
                            }
                        } else {
                            this.isBeingPulled = false;
                        }

                        // Target position based on angle and modified distance
                        const idealX = centerX + Math.cos(this.angle) * orbitDist;
                        const idealY = centerY + Math.sin(this.angle) * orbitDist;

                        // Smooth lerp to target (Fluid physics)
                        this.x += (idealX - this.x) * pullStrength;
                        this.y += (idealY - this.y) * pullStrength;
                    }

                    draw(ctx) {
                        // Draw Orbit line (trail) - optional visual flair
                        /* 
                        ctx.strokeStyle = 'rgba(255,255,255,0.02)';
                        ctx.beginPath();
                        ctx.arc(centerX, centerY, this.baseOrbitDist, 0, Math.PI*2);
                        ctx.stroke();
                        */

                        // Glow if pulled
                        if (this.isBeingPulled) {
                            ctx.shadowBlur = 20;
                            ctx.shadowColor = '#818cf8'; // Indigo glow
                        } else {
                            ctx.shadowBlur = 10;
                            ctx.shadowColor = 'rgba(0,0,0,0.5)';
                        }

                        // Draw Circle Mask
                        ctx.save();
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                        ctx.closePath();
                        ctx.clip();

                        // Draw Image
                        try {
                            ctx.drawImage(this.img, this.x - this.radius, this.y - this.radius, this.size, this.size);
                        } catch (e) { }

                        ctx.restore();

                        // Border ring
                        ctx.shadowBlur = 0;
                        ctx.lineWidth = 2;
                        if (this.isBeingPulled) {
                            ctx.strokeStyle = '#6366f1';
                        } else {
                            ctx.strokeStyle = `rgba(255,255,255,${this.data.average / 150})`; // White opacity based on score
                        }
                        ctx.stroke();
                    }

                    isHovering(mx, my) {
                        const dist = Math.hypot(this.x - mx, this.y - my);
                        return dist < this.radius;
                    }
                }

                const initGalaxy = () => {
                    canvas = document.getElementById('galaxyCanvas');
                    ctx = canvas.getContext('2d');

                    const handleResize = () => {
                        canvas.width = window.innerWidth;
                        canvas.height = window.innerHeight;
                        centerX = canvas.width / 2;
                        centerY = canvas.height / 2;
                    };
                    window.addEventListener('resize', handleResize);
                    handleResize();

                    // Preload Images & Create Planets
                    let loadedCount = 0;
                    candidates.value.forEach(cand => {
                        const img = new Image();
                        img.src = cand.avatar;
                        img.onload = () => {
                            loadedCount++;
                            // Ready if needed
                        };
                        planets.push(new Planet(cand, img));
                    });

                    // Start Loop
                    animate();

                    // Mouse Interaction
                    canvas.addEventListener('mousemove', (e) => {
                        const rect = canvas.getBoundingClientRect();
                        const mx = e.clientX - rect.left;
                        const my = e.clientY - rect.top;

                        let hit = null;
                        for (let p of planets) {
                            if (p.isHovering(mx, my)) {
                                hit = p;
                                break;
                            }
                        }

                        if (hit) {
                            hoveredCandidate.value = hit.data;
                            tooltipPos.value = { x: hit.x + 30, y: hit.y - 30 };
                            document.body.style.cursor = 'pointer';
                        } else {
                            hoveredCandidate.value = null;
                            document.body.style.cursor = 'default';
                        }
                    });
                };

                const animate = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear screen

                    // Draw Central Sun (Job)
                    // Pulse Effect
                    const time = Date.now() * 0.002;
                    const sunRadius = 50 + Math.sin(time) * 2;

                    // Sun Glow
                    ctx.shadowBlur = 50;
                    ctx.shadowColor = '#4f46e5';
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, sunRadius, 0, Math.PI * 2);
                    ctx.fillStyle = '#1e1b4b'; // Dark indigo core
                    ctx.fill();

                    // Sun Text
                    ctx.shadowBlur = 0;
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 12px Outfit';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText('JOB ROLE', centerX, centerY);

                    // Orbit Rings (Background)
                    ctx.strokeStyle = 'rgba(255,255,255,0.03)';
                    ctx.lineWidth = 1;
                    [150, 300, 450].forEach(r => {
                        ctx.beginPath();
                        ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                        ctx.stroke();
                    });

                    // Render Planets
                    planets.forEach(p => {
                        p.update(activeGravity.value);
                        p.draw(ctx);
                    });

                    animationFrameId = requestAnimationFrame(animate);
                };

                onMounted(() => {
                    initGalaxy();
                });

                // Watchers for cleanup if needed

                return {
                    activeGravity,
                    skills,
                    hoveredCandidate,
                    tooltipPos,
                    toggleGravity,
                    resetGravity
                };
            }
        }).mount('#app');
    </script>
</body>

</html>