<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talent Matrix Comparison</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .slide-enter-active,
        .slide-leave-active {
            transition: transform 0.3s ease-out;
        }

        .slide-enter-from,
        .slide-leave-to {
            transform: translateX(100%);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#64748b',
                    }
                }
            }
        }
    </script>
</head>

<body class="h-screen overflow-hidden text-slate-800 flex flex-col">

    <div id="app" class="h-full flex relative overflow-hidden">

        <!-- Left Sidebar: Metric Selector (Y Axis) -->
        <aside class="w-80 bg-white border-r border-slate-200 flex flex-col z-20 shadow-lg">

            <div class="px-6 py-6 border-b border-slate-100">
                <h1 class="text-xl font-bold text-slate-900 tracking-tight flex items-center gap-2">
                    <div class="w-8 h-8 rounded-lg bg-indigo-600 flex items-center justify-center text-white text-xs">TM
                    </div>
                    Talent Matrix
                </h1>
                <p class="text-xs text-slate-500 mt-2">Select a metric below to compare against <span
                        class="font-bold text-indigo-600">Experience</span>.</p>
            </div>

            <div class="flex-1 overflow-y-auto p-4 space-y-3">
                <div v-for="metric in otherMetrics" :key="metric.name" @mouseenter="previewMetric(metric.name)"
                    @click="setYAxis(metric.name)"
                    class="group p-4 rounded-xl cursor-pointer border transition-all duration-200 relative overflow-hidden"
                    :class="[
                        yAxis === metric.name 
                            ? 'bg-indigo-50 border-indigo-200 shadow-md transform scale-[1.02]' 
                            : 'bg-white border-slate-100 hover:border-indigo-100 hover:bg-slate-50 hover:shadow-sm'
                     ]">

                    <!-- Active Indicator -->
                    <div v-if="yAxis === metric.name" class="absolute left-0 top-0 bottom-0 w-1 bg-indigo-500"></div>

                    <div class="flex items-center justify-between mb-1">
                        <span class="font-bold text-sm"
                            :class="yAxis === metric.name ? 'text-indigo-900' : 'text-slate-700'">{{ metric.name
                            }}</span>
                        <span
                            class="text-xs font-mono bg-slate-100 px-1.5 py-0.5 rounded text-slate-500 group-hover:bg-white transition-colors">Y-Axis</span>
                    </div>
                    <p class="text-xs text-slate-400 line-clamp-2 leading-relaxed">{{ metric.desc }}</p>

                </div>
            </div>

            <!-- Lock Info -->
            <div class="p-4 bg-slate-50 border-t border-slate-200 text-xs text-slate-400">
                <div class="flex items-center gap-2 mb-1">
                    <svg class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                    <span class="font-semibold uppercase tracking-wider">X-Axis Locked</span>
                </div>
                Experience (Years/Relevance)
            </div>
        </aside>

        <!-- Main Chart Generation -->
        <main class="flex-1 relative bg-slate-100/50 flex flex-col overflow-hidden">

            <!-- Grid Background Lines (Decorative) -->
            <div class="absolute inset-0 pointer-events-none opacity-40 mix-blend-multiply"
                style="background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 40px 40px;">
            </div>

            <!-- Quadrant Labels -->
            <div class="absolute inset-0 flex flex-col pointer-events-none z-0 p-8">
                <div class="flex-1 flex">
                    <div
                        class="flex-1 border-r border-b border-dashed border-slate-300 flex items-start justify-start p-4">
                        <span
                            class="text-[10px] font-bold text-slate-400 uppercase tracking-widest bg-white/60 px-2 py-1 rounded backdrop-blur-sm">Potential</span>
                    </div>
                    <div class="flex-1 border-b border-dashed border-slate-300 flex items-start justify-end p-4">
                        <span
                            class="text-[10px] font-bold text-indigo-500 uppercase tracking-widest bg-indigo-50/80 px-2 py-1 rounded backdrop-blur-sm ring-1 ring-indigo-100">Top
                            Performers</span>
                    </div>
                </div>
                <div class="flex-1 flex">
                    <div class="flex-1 border-r border-dashed border-slate-300 flex items-end justify-start p-4">
                        <span
                            class="text-[10px] font-bold text-slate-300 uppercase tracking-widest bg-white/60 px-2 py-1 rounded backdrop-blur-sm">Developing</span>
                    </div>
                    <div class="flex-1 flex items-end justify-end p-4">
                        <span
                            class="text-[10px] font-bold text-slate-400 uppercase tracking-widest bg-white/60 px-2 py-1 rounded backdrop-blur-sm">Seasoned</span>
                    </div>
                </div>
            </div>

            <!-- The Chart -->
            <div class="flex-1 p-6 relative z-10 w-full h-full">
                <canvas id="talentMatrix"></canvas>
            </div>

            <!-- Bottom X Axis Label Area -->
            <div class="h-12 bg-white border-t border-slate-200 flex items-center justify-center relative z-20">
                <span class="text-sm font-bold text-indigo-600 uppercase tracking-widest mr-2">Experience</span>
                <span class="text-xs text-slate-400 font-medium">(X-Axis)</span>
            </div>

        </main>

        <!-- Right Offcanvas Details Panel -->
        <transition name="slide">
            <div v-if="selectedCandidate"
                class="absolute top-4 bottom-4 right-4 w-80 bg-white rounded-2xl shadow-2xl z-50 flex flex-col border border-slate-100 overflow-hidden transform">

                <!-- Close Button -->
                <button @click="selectedCandidate = null"
                    class="absolute top-4 right-4 p-2 bg-white/50 backdrop-blur rounded-full hover:bg-slate-100 transition-colors z-10">
                    <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>

                <!-- Header Image -->
                <div class="h-32 bg-slate-100 relative">
                    <img :src="selectedCandidate.avatar" class="w-full h-full object-cover opacity-90">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                    <div class="absolute bottom-4 left-4 text-white">
                        <h2 class="text-lg font-bold leading-tight">{{ selectedCandidate.name }}</h2>
                        <p class="text-xs opacity-90 font-medium">{{ selectedCandidate.role }}</p>
                    </div>
                </div>

                <!-- Content -->
                <div class="flex-1 overflow-y-auto p-6 space-y-6">

                    <!-- Key Stats -->
                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-indigo-50 p-3 rounded-lg text-center border border-indigo-100">
                            <div class="text-xs text-indigo-400 uppercase font-bold tracking-wider mb-1">Exp</div>
                            <div class="text-2xl font-bold text-indigo-700">{{ selectedCandidate.stats.Experience }}
                            </div>
                        </div>
                        <div class="bg-emerald-50 p-3 rounded-lg text-center border border-emerald-100">
                            <div class="text-xs text-emerald-400 uppercase font-bold tracking-wider mb-1">Avg</div>
                            <div class="text-2xl font-bold text-emerald-700">{{ selectedCandidate.average }}</div>
                        </div>
                    </div>

                    <!-- Full Breakdown -->
                    <div>
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Skill Breakdown</h3>
                        <div class="space-y-3">
                            <div v-for="(val, key) in selectedCandidate.stats" :key="key" class="group">
                                <div class="flex justify-between text-xs mb-1">
                                    <span
                                        class="font-medium text-slate-600 group-hover:text-indigo-600 transition-colors">{{
                                        key }}</span>
                                    <span class="font-bold text-slate-800">{{ val }}</span>
                                </div>
                                <div class="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-slate-300 group-hover:bg-indigo-500 transition-colors"
                                        :style="{width: val + '%'}"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button
                        class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-500/30 transition-all transform active:scale-95 text-sm">
                        View Full Profile
                    </button>

                </div>
            </div>
        </transition>

    </div>

    <!-- Custom Chart Plugin for Images -->
    <script>
        const imagePlugin = {
            id: 'customImage',
            afterDatasetDraw(chart, args, options) {
                const { ctx, data, scales: { x, y } } = chart;

                ctx.save();

                data.datasets[0].data.forEach((datapoint, index) => {
                    const applicant = datapoint.rawApplicant;
                    if (!applicant.imgObj) return;

                    const xPos = x.getPixelForValue(datapoint.x);
                    const yPos = y.getPixelForValue(datapoint.y);
                    const size = 42;

                    // Draw Shadow
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
                    ctx.shadowBlur = 10;
                    ctx.shadowOffsetY = 4;

                    // Draw Circle Clip
                    ctx.beginPath();
                    ctx.arc(xPos, yPos, size / 2, 0, Math.PI * 2, true);
                    ctx.closePath();

                    // Highlight selected
                    if (applicant.selected) {
                        ctx.lineWidth = 4;
                        ctx.strokeStyle = '#6366f1'; // Indigo 500
                        ctx.stroke();
                    }

                    ctx.save();
                    ctx.clip();

                    // Draw Image
                    try {
                        ctx.drawImage(applicant.imgObj, xPos - size / 2, yPos - size / 2, size, size);
                    } catch (e) { }

                    ctx.restore();

                    // Draw Border if not selected (white rim)
                    if (!applicant.selected) {
                        ctx.shadowColor = 'transparent';
                        ctx.lineWidth = 2;
                        ctx.strokeStyle = '#fff';
                        ctx.stroke();
                    }

                });

                ctx.restore();
            }
        };

        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const otherMetrics = [
                    { name: 'Leadership', desc: 'Ability to lead teams and manage projects.' },
                    { name: 'Education', desc: 'Academic background and theoretical knowledge.' },
                    { name: 'Certification', desc: 'Relevant professional certifications acquired.' },
                    { name: 'Achievements', desc: 'Awards, recognitions, and major milestones.' },
                    { name: 'Innovation', desc: 'History of creative problem solving and patents.' }
                ];

                const xAxis = ref('Experience');
                const yAxis = ref('Leadership');
                const selectedCandidate = ref(null);

                // Generated 13 candidates with UNIQUE avatars
                const applicants = ref([
                    { id: 1, name: "Sarah Chen", role: "Product Design", avatar: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 92, Education: 85, Leadership: 78, Certification: 80, Achievements: 95, Innovation: 88 } },
                    { id: 2, name: "Michael Torres", role: "Engineering", avatar: "https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 75, Education: 88, Leadership: 65, Certification: 95, Achievements: 80, Innovation: 70 } },
                    { id: 3, name: "Emma Wilson", role: "Marketing", avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 88, Education: 82, Leadership: 96, Certification: 70, Achievements: 90, Innovation: 85 } },
                    { id: 4, name: "David Kim", role: "Data Science", avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 85, Education: 98, Leadership: 70, Certification: 88, Achievements: 85, Innovation: 92 } },
                    { id: 5, name: "Olivia James", role: "Research", avatar: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 80, Education: 85, Leadership: 75, Certification: 70, Achievements: 78, Innovation: 65 } },
                    { id: 6, name: "James Liu", role: "Backend Dev", avatar: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 65, Education: 70, Leadership: 50, Certification: 85, Achievements: 60, Innovation: 75 } },
                    { id: 7, name: "Sophia Miller", role: "Sales Lead", avatar: "https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 95, Education: 60, Leadership: 90, Certification: 50, Achievements: 98, Innovation: 40 } },
                    { id: 8, name: "Lucas Brown", role: "DevOps", avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 78, Education: 80, Leadership: 60, Certification: 98, Achievements: 75, Innovation: 68 } },
                    { id: 9, name: "Ava Taylor", role: "Product Manager", avatar: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 82, Education: 85, Leadership: 88, Certification: 75, Achievements: 80, Innovation: 82 } },
                    { id: 10, name: "Ethan Hunt", role: "Security", avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 88, Education: 75, Leadership: 70, Certification: 100, Achievements: 85, Innovation: 60 } },
                    { id: 12, name: "Mason Clark", role: "Accountant", avatar: "https://images.unsplash.com/photo-1599566150163-29194dcaad36?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 70, Education: 90, Leadership: 55, Certification: 95, Achievements: 70, Innovation: 40 } },
                    { id: 13, name: "Mia Davis", role: "HR Manager", avatar: "https://images.unsplash.com/photo-1491349174775-aaafddd81942?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 85, Education: 80, Leadership: 92, Certification: 85, Achievements: 88, Innovation: 75 } },
                    // Low Scoring Candidates (Unique Avatars)
                    { id: 14, name: "Kevin White", role: "Junior Intern", avatar: "https://images.unsplash.com/photo-1595152772835-219674b2a8a6?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 20, Education: 40, Leadership: 15, Certification: 10, Achievements: 15, Innovation: 25 } },
                    { id: 15, name: "Liam Harris", role: "Support", avatar: "https://images.unsplash.com/photo-1502452213786-a5bc0a67e963?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 35, Education: 30, Leadership: 25, Certification: 20, Achievements: 30, Innovation: 15 } },
                    { id: 18, name: "Chris Green", role: "Analyst", avatar: "https://images.unsplash.com/photo-1504257432389-52343af06ae3?ixlib=rb-4.0.3&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80", stats: { Experience: 45, Education: 40, Leadership: 30, Certification: 40, Achievements: 35, Innovation: 45 } }
                ]);

                // Calculate Averages
                applicants.value.forEach(app => {
                    const vals = Object.values(app.stats);
                    app.average = Math.round(vals.reduce((a, b) => a + b, 0) / vals.length);
                    app.selected = false;
                });

                let chart = null;

                const loadImages = () => {
                    applicants.value.forEach(app => {
                        const img = new Image();
                        img.src = app.avatar;
                        app.imgObj = img;
                    });
                };

                const setYAxis = (metric) => {
                    if (yAxis.value === metric) return;
                    yAxis.value = metric;
                    updateChart();
                };

                const previewMetric = (metric) => {
                    // Optional: Hover could temporarily show potential movement
                    // For now, simpler to just let click handle it properly or immediate update (optional in prompt)
                    // Prompt said "hovering over should change the graph". 
                    setYAxis(metric);
                };

                const initChart = () => {
                    const ctx = document.getElementById('talentMatrix').getContext('2d');

                    chart = new Chart(ctx, {
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: 'Candidates',
                                data: generateData(),
                                pointRadius: 25,
                                pointHoverRadius: 28,
                                pointBackgroundColor: 'transparent',
                                pointBorderColor: 'transparent',
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            layout: { padding: 40 },
                            onClick: (e, elements) => {
                                if (elements.length > 0) {
                                    const index = elements[0].index;
                                    const app = chart.data.datasets[0].data[index].rawApplicant;
                                    selectCandidate(app);
                                } else {
                                    // Clicked empty space
                                    selectedCandidate.value = null;
                                    applicants.value.forEach(a => a.selected = false);
                                    chart.update();
                                }
                            },
                            scales: {
                                x: {
                                    type: 'linear',
                                    position: 'bottom',
                                    min: 0, max: 100,
                                    grid: { display: true, color: '#e2e8f0', drawBorder: false }, // Show light grid
                                    border: { display: false },
                                    ticks: {
                                        display: true, // Show numbers
                                        color: '#94a3b8',
                                        font: { family: 'Inter', size: 10, weight: '600' },
                                        padding: 10
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    position: 'left',
                                    min: 0, max: 100,
                                    grid: { display: true, color: '#e2e8f0', drawBorder: false },
                                    border: { display: false },
                                    ticks: {
                                        display: true, // Show numbers
                                        color: '#94a3b8',
                                        font: { family: 'Inter', size: 10, weight: '600' },
                                        padding: 10
                                    }
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false } // Using Custom Sidebar instead
                            },
                            animation: {
                                duration: 800,
                                easing: 'easeOutQuart'
                            }
                        },
                        plugins: [imagePlugin]
                    });
                };

                const generateData = () => {
                    return applicants.value.map(app => ({
                        x: app.stats[xAxis.value],
                        y: app.stats[yAxis.value],
                        rawApplicant: app
                    }));
                };

                const updateChart = () => {
                    if (!chart) return;
                    chart.data.datasets[0].data = generateData();
                    // 'active' mode enables smoother transitions for changing values
                    chart.update('active');
                };

                const selectCandidate = (app) => {
                    applicants.value.forEach(a => a.selected = false);
                    app.selected = true;
                    selectedCandidate.value = app;
                    // Standard update for selection state change
                    chart.update();
                };

                onMounted(() => {
                    loadImages();
                    setTimeout(initChart, 200);
                });

                return {
                    otherMetrics,
                    yAxis,
                    applicants,
                    selectedCandidate,
                    setYAxis,
                    previewMetric
                };
            }
        }).mount('#app');
    </script>
</body>

</html>